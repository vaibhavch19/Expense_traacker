{% extends "base.html" %}
{% block content %}
<h2>Set Monthly Budgets by Category</h2>
<form method="post">
    {{ form.hidden_tag() }}

    <div>
        {{ form.category.label }}<br>
        {{ form.category() }}
    </div>

    <div style="margin-top:1em;">
        {{ form.month.label }}<br>
        {{ form.month(size=10) }}
        <small>Format: YYYY-MM</small>
    </div>

    <div style="margin-top:1em;">
        {{ form.amount.label }}<br>
        {{ form.amount() }}
    </div>

    <div style="margin-top:1.6em;">
        {{ form.submit(class_="btn") }}
    </div>
</form>

<h3 style="margin-top: 3em;">Current Budgets</h3>
<table>
    <thead>
        <tr><th>Month</th><th>Category</th><th>Amount (â‚¹)</th><th>Actions</th></tr>
    </thead>
    <tbody>
    {% for b in budgets %}
    <tr>
        <td>{{ b.month }}</td>
        <td>{{ b.category }}</td>
        <td>{{ '%.2f'|format(b.amount) }}</td>
        <td>
          <div class="action-btns">
            <form action="{{ url_for('edit_budget', budget_id=b.id) }}" method="get" style="display:inline;">
              <button type="submit" class="btn edit-btn">Edit</button>
            </form>

            <form method="POST" action="{{ url_for('delete_budget', budget_id=b.id) }}" style="display:inline;"
                  onsubmit="return confirm('Are you sure you want to delete this budget?');">
              <button type="submit" class="btn delete-btn">Delete</button>
            </form>
          </div>
        </td>
    </tr>
    {% else %}
    <tr><td colspan="4" style="text-align:center; color:#666;">No budgets set yet.</td></tr>
    {% endfor %}
    </tbody>
</table>

{% endblock %}
